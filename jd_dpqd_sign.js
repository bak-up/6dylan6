/*
活动名称：批量店铺签到
活动链接：https://h5.m.jd.com/babelDiy/Zeus/2PAAf74aG3D61qvfKUM5dxUssJQ9/index.html?token=<token>
环境变量：jd_dpqd_tokens // 活动令牌，多个用英文逗号，@，&，换行分割
        jd_dpqd_task_threads // 控制签到并发线程数（正整数），默认1
        jd_dpqd_account_threads // 控制账号并发线程数（正整数），默认1
        jd_dpqd_account_interval // 自定义运行间隔时长（整数，单位毫秒），默认0
        jd_dpqd_max_retry // 签到火爆时的最大重试次数（整数），默认3
        jd_dpqd_prize_notify // 是否推送中奖信息（true/false），默认不推送

此脚本为高并发签到本，需要读取主脚本生成的活动信息缓存，自动过滤无效活动，签到后如有奖品则自动到账


cron:1 1 1 1 *

*/

const $ = new Env('批量店铺签到')
var iｉl='jsjiami.com.v7';const i1iIi1=iii1II;(function(IIii11,iliIl1,Ii1il1,iii1ll,IIliI1,il1lI,IliIIl){return IIii11=IIii11>>0x6,il1lI='hs',IliIIl='hs',function(I1il1l,lI1l1l,IIliII,iiliI,Ill11I){const llI11i=iii1II;iiliI='tfi',il1lI=iiliI+il1lI,Ill11I='up',IliIIl+=Ill11I,il1lI=IIliII(il1lI),IliIIl=IIliII(IliIIl),IIliII=0x0;const I1il1i=I1il1l();while(!![]&&--iii1ll+lI1l1l){try{iiliI=parseInt(llI11i(0x16a,'gIPA'))/0x1+-parseInt(llI11i(0x19c,'W&T@'))/0x2+parseInt(llI11i(0x151,'Z^o&'))/0x3*(-parseInt(llI11i(0x132,'2bld'))/0x4)+-parseInt(llI11i(0x11e,'8UP1'))/0x5*(parseInt(llI11i(0x159,'02V4'))/0x6)+parseInt(llI11i(0x17e,'bgnZ'))/0x7*(parseInt(llI11i(0x1cd,'2bld'))/0x8)+-parseInt(llI11i(0x188,'MCM2'))/0x9+parseInt(llI11i(0x139,'O#6&'))/0xa*(parseInt(llI11i(0x1fc,'w]N1'))/0xb);}catch(IliIIi){iiliI=IIliII;}finally{Ill11I=I1il1i[il1lI]();if(IIii11<=iii1ll)IIliII?IIliI1?iiliI=Ill11I:IIliI1=Ill11I:IIliII=Ill11I;else{if(IIliII==IIliI1['replace'](/[JQNORnHbBefCUWYtTPdA=]/g,'')){if(iiliI===lI1l1l){I1il1i['un'+il1lI](Ill11I);break;}I1il1i[IliIIl](Ill11I);}}}}}(Ii1il1,iliIl1,function(lI1l1i,i1iil,llI11l,I1llIl,i1iii,I1llIi,IIii1I){return i1iil='\x73\x70\x6c\x69\x74',lI1l1i=arguments[0x0],lI1l1i=lI1l1i[i1iil](''),llI11l=`\x72\x65\x76\x65\x72\x73\x65`,lI1l1i=lI1l1i[llI11l]('\x76'),I1llIl=`\x6a\x6f\x69\x6e`,(0x15bd7c,lI1l1i[I1llIl](''));});}(0x2f00,0x353c3,Iii11l,0xbe),Iii11l)&&(iｉl=0xd7b);function Iii11l(){const II11ii=(function(){return[...[iｉl,'QbjYHsJQjPftiaOminW.ARcPomJT.vNH7UeCedRB==','W5X6AJu','WOuvkmkheG','D8klW4a','keNcUhVdMmoWWQ/dNw1ZatjwtIFdNCoesd9TWP3dOmoGBUAmUowkQoEVMEwjHow5KEwmGU++QUM5G+ITLxO','WPdcVaNdRba','W6ZdTMKtW4ddImoT','jSoan00VnCkvWRa','EwfGgh8','iaHdc2K','lSofWP8SW6O','kf0GWPNcJ8oi','WOxdMxK','WPdcOH/dLca','4P6WmUIeU+AFRoI/UoIHHoMaU+wjJEs6UUMxVEISPN8','juLSEZ8','v8opWQ9jwq','W71RFSowCW','WOpdTd4tt8oaF1FdQsddMa9eW6hcKCoeceJdQbBdR3tcP8oL','WQVcLZxdOHpcQGrn','nLi6WOJcQCovWOep','bfvoDddcPCoH','W6pcRxpcQx/dJZGeW6VcKG','WOZcMYBdNs4','EM98i0W','DmkbW6C','W5dcRupdNmkq','iCoNWRGhW6jb','W6ldIYNcVh8','CH3dLW','cmoMiCoOxq','hUA0H+wkIowKV+EaT+ElJW','f8o1c2eZ','WPlcIfje','WQBcJ2zNpG','WP7dGCoBWQ7dSvKV','t8kUWOiM','FXZcSKJdNG','b8o+WR4AW68','nCoakLG','WQj5WQbCW5W','dLnh','W4JdQmkK','W6BdHx4DW6W','4P+TzEAFMoIbRoATHoEGJ+wLNEEsH8ou','dJvK','wX7cM3BdJa','W67dHg3cOcNcUWTSW6hdHa','5l2B5Ooh5yI48loeQE+5Iq','d0ejWP/cIa','WPTvvCkMtW','W67dVgez','euXmFcG','AmoMWRK','WQBdRN1/eW','WRGMneG','WQv1W4FcHZC','WP4Jp0j+','W4ZcMgRcVKW','WRpcQ8olW6S5k8kXAHtdVKBdP2NdOG','lmo7WQW','W5VINirX56Y25yIX5OU+5yMq','W6ZcIeFdOSkv','k1CmWPJcJConWOG1qdhdRXJcIcVcMCoTyH7cRSkAi8kNWPq','WONdIgaGdqdcRqpdISkQW4OS','WPJdTcSYsW','o1T+WR/cS8kqWPycdbRdRrNcJN7cNmkpjLJdPq','WRJcOCoy','W5RcQwFdKmkc','WRhcHtS','WONdL8kfWOS/','W5ZOR6xMSApLKi3LURWO','WPRdQYiHzSka','WPhcMfu','W7TtWPCO','W4ldJmkoW6FdMa','W6ldPCkgEui','WOZdHZ4fwW','WRBcMmojW4iF','W5nnFSoNxmoG','zGtcRmojW6qT','WRSSnhHO','6lAG5yYI5PE65PAs','W4fDySo2','c3r3W6VcUW','mY/cMZtcGCkhxmoLWR3dRgGfA3egW6VdU8keWR1/','WQtORAtMSyRLKRRLUlhcMG','WPBcPmoAW4Cb','tCkMhmoKuSkwnGXaW6yNjNb4W7OjsmomrdHDESkVySoJW6ldQG','W5hdJSkosKG','DvpdLLHDW6ddOrhdVCkFDW'],...(function(){return[...['sCkUWOW','5BMR6zoO56Eo5yUg8jwoL++5SW','44of6lwy5y6l','dv3cUv3dHafcW5y','f8o7umov','WRtdOspdOJpdRqCvW7lcHWW','W6FcShRdNCkV','WRHdW6raW5PCW6FcSbVdKMfzW4SgW6xdKSktowRcJW','W4vryCo7','uapcSa','WOVdL21R','WOTZsmk0Fgerga','WPhdVa4SCCkFWQSvu8kcWQtdSLBdOSk1BYNcSmkNWQ0CW6LSWQNdUa7dQoApJUwiTEI2K+woO+w6OEwmPo+9MEM4G+ITOCop','5Rw55yQf5Bsv57Um5P+3','WOHwB8kzsG','WRzgW49f','WQFcU8oCW4SZn8kP','WOddJ8oDWPpdSvmV','W4XcWQOdWQq','pCoooq','zGtcRa','uG3cUNC','mY/cMZtcGCkhxmoLWRldVwqrEKCFW4hdHmkfWQf7xmoiWRHSoK7cUwpdTCoBDLddQvfoWR9AW5i+W5u','W7j/W5tdNSka','WQdINzW156+V5yUu5OUm5yIH77Yq6i+J5B6c77+H','kf7cIhhdMmkWW7VcSIO','WPxdUtWT','W7PlWRykWPW','5P6c552k5AAr5zge7760','W53dHmkuw28','W6/dPmkLweG','WOBcGmkYW7hdLCkBWRy3W4P9rSkQW7NdJ8ohWR4','vbxcVgxdRa','W5FdTSk3FMW','kmovWRiAW4W','Dg7cMIxcMSkktmk+WR/dU2mAyLeYW7tdK8kUWQfMySooWRe','W79GDmoHCG','WPSmk8kcfG','kxtcLSkBEa','5yAr57Qf5y6+8jALJq','FSkcW6/cTHi','WOZdPt4','W6hdUSkWW7ddSG','W68oWOtdG1e','W6GxWR3dMfC','amozASo7oa','ESkzW7u','WQdINzW16k2M5RkM5AET6lAB77Yu','n8oimK0ElG','b1lcImkryq','W7FdPMSuW4ddICoT','wmkYW5C','kZmKqYBcNh3dUeWiW5ndmW','WO9cW4FcJrlcJt/cQq','5ysdW5hLJQRWPkYe','WRNcP8or','W6JcKJ3cPxq','iMFcICkr','tSo+WO5uxa','6lEk5y+A5Pwj5PAMzVgeM6C','W6JdTMyqW5hdKG','WQdcLwD0hG','WP/dLcxdJa','oSo5DCo+ia','fmo0WOisgcVdHmoc','mColWO0','776T8l6PQa','W4H0zYrGWQDgpW','rwD4neC','4PIMW7xOR63LHPlLRPhKU7xLVQ7OP7ZNMihNJz7LO7JLJ4pPH5VLK5BLHOxOVlpOOQNOHAxMNkVVVPG','s8kUW4yReG/dPW','WR/cGSoWW50d','W63dJ2ZcRNxdUW1+W6pdR8kQW6S','ACkBW5xcJGO','CtVdMCojnY0ln8oRxW','WQ/cHYJdUc0','FmkpW7tcUa','WOxcRfLvca','WQm3W7Ce','WR7cILpdIXHUj8kVeCo0WObMta','WRLPWQXfW5LTqK3cMNDXWRb6W4Wa','W4VdSSk3vMRdJcK','WPzNW4JcNqm','k8o7WQ19FSk3WQZcLSouW6aBW47cHNlcU2hdNhVdSLy','FSkgW7pdSgq','WORcQmkPDexdGIhdMe7cNG','WRxcQJHpWPFcGSo6WPFdQbnPW7K','FfLZ','5RsX5yUd5P+H5B6m5AwD','oZlcNdJcLmki','W4BdUmkYW6hdKa','uCk5W4/cUfO5'],...(function(){return['W5NcHmkA','WPZdNYuUzG','w8k1W43cQ0SJ','W4ldLNiyW4G','lKjZW4lcMseO','W6xcQwldGCkY','WONdI8oAWOe','W6RcPeRdTCkuWQ3dMKm5DmkdhsNdKmkGW7iK','W5mGWPpdTweinCoKWQCdzCkT','5lMU5PwI5BsX562U','WQNdQaW7tq','dmoPW4JcHuShuCof','W5RdTSkiW5tdTa','W7tdPNSF','WQxdKJZdU2G','moA0VEwjJowNNUEbOEEiLG','WQLVWQ9o','W6lcR3RdVCkbWR3dKa','WPrFWP8aWR4','WPldSCkKFfxdHYK','WObcW44','WRC5W7aeWPPxsq','W6hcKM7cVgW','W43INlBcJUEUNUwkOowKHEI1R++9SW','ltnTpMW','6lAc5y+L5PE35PwjtpcYUki','l3tcGCkvFNu','BYJcOSobW5G','WRixW5uiWPK','vb3cRN/dSW','W4tdGmkG','Er/cUCoLW7G4jdKC','vLrrpei','W6tcOwhdSa','WPerW7i1WQu','WQCZW6O','W5ZcMmkwW5dcPWqFe3FcUbdcMW','W5fIC2ayW5pdISoFWOpcL8oux2i','lLrN','rGBcHwddJW','4P6yDUAEToIcJEAUNoEHL+wKUEEqH8kM','jMlcU8kqEMfsvCkIdqpcPmkCcq','WPZdOsmxAmktpr0','W7ddNeueW78','W6JdVg8','oUkENdtNRixLIkFLPPROTAJcLXvp','W5VdJmk1W6ZdJmkd','WO/dKdJdTuJdRq4mW7NcMG','WP7dTcXoba','BmkfW47dSG','vuzbf1y','f8oKjfyw','W5RcSsqSuSkwkbW','W4bTx8ojDW','WORdRN9Kkq','WOhcKKvj','kmovWPBcS3ijWPZdVmkLWOu','WQW7m1DmWQpcGwS2','W4DZW4JdOmkr','WRXsWQ5JW40','j0pcKq','W67dKHC','AmkmW47dOgO','WRWxW6CeWRy','b0JcKeFdNa','W4JINkqP562W5yMq5AsF6lEI772V','WRGuW5n+W6xdPWm+WR88W4pcOq','WQvlWPCrWRm','iI3cHbpcLW','m8o4w8oZoa','kunFW5xcIdCPiCk3fmobWR05m8k1rGVcIKtcPCkeWOtcNCk0jKZdSCks6isZ5A295lI16lY+6kkk6zEL6zMe5Pwg6zwa','CvBdK3GD','Du9bovu','Ew9WhG','W6VdMSkUW6FdIq','fv1jyqJcOmo1W6q','WO7dUuj2bG','W7bWxmoRDG','WPZdVsuanmkDWRS','WOpdKdxdIW','5yYt6yw86kYA5PUwv29fACoCCmkGW7vsnG','WPL8vW','vbJcRxFdVq','c1NdPIhcML9DW7mryCoyWPC','WPCJjJqaW47dMSo5WQVcQG','WQFdNmkj','of/dSSk0WQ4oitCsW4y3','W7/dTaJcI0m','WOPxWQSXWQRcKSoGWPVdPSofW5qOWRldHqmiBmolo8o5'];}())];}())];}());Iii11l=function(){return II11ii;};return Iii11l();};const jdCookie=require(i1iIi1(0x13f,'02V4')),notify=require(i1iIi1(0x1f6,'PF55')),common=require(i1iIi1(0x10d,'b83E')),{H5st}=require(i1iIi1(0x109,'9pxK'));function iii1II(_0x3022ca,_0x54d4ec){const _0x4fcbe6=Iii11l();return iii1II=function(_0x31eabb,_0x522851){_0x31eabb=_0x31eabb-0xf6;let _0x49c84f=_0x4fcbe6[_0x31eabb];if(iii1II['BfknoV']===undefined){var _0x5de39a=function(_0x5ddc8b){const _0x6af04a='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x574fc4='',_0x41bba9='';for(let _0x657ca3=0x0,_0x375682,_0x50710b,_0x12cd58=0x0;_0x50710b=_0x5ddc8b['charAt'](_0x12cd58++);~_0x50710b&&(_0x375682=_0x657ca3%0x4?_0x375682*0x40+_0x50710b:_0x50710b,_0x657ca3++%0x4)?_0x574fc4+=String['fromCharCode'](0xff&_0x375682>>(-0x2*_0x657ca3&0x6)):0x0){_0x50710b=_0x6af04a['indexOf'](_0x50710b);}for(let _0x4a6cec=0x0,_0xcc220=_0x574fc4['length'];_0x4a6cec<_0xcc220;_0x4a6cec++){_0x41bba9+='%'+('00'+_0x574fc4['charCodeAt'](_0x4a6cec)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x41bba9);};const _0x4bd95b=function(_0x5c1ddd,_0x55df6a){let _0x3fdeb1=[],_0x561960=0x0,_0x578ab5,_0x3b17d5='';_0x5c1ddd=_0x5de39a(_0x5c1ddd);let _0xec0fb1;for(_0xec0fb1=0x0;_0xec0fb1<0x100;_0xec0fb1++){_0x3fdeb1[_0xec0fb1]=_0xec0fb1;}for(_0xec0fb1=0x0;_0xec0fb1<0x100;_0xec0fb1++){_0x561960=(_0x561960+_0x3fdeb1[_0xec0fb1]+_0x55df6a['charCodeAt'](_0xec0fb1%_0x55df6a['length']))%0x100,_0x578ab5=_0x3fdeb1[_0xec0fb1],_0x3fdeb1[_0xec0fb1]=_0x3fdeb1[_0x561960],_0x3fdeb1[_0x561960]=_0x578ab5;}_0xec0fb1=0x0,_0x561960=0x0;for(let _0x35429c=0x0;_0x35429c<_0x5c1ddd['length'];_0x35429c++){_0xec0fb1=(_0xec0fb1+0x1)%0x100,_0x561960=(_0x561960+_0x3fdeb1[_0xec0fb1])%0x100,_0x578ab5=_0x3fdeb1[_0xec0fb1],_0x3fdeb1[_0xec0fb1]=_0x3fdeb1[_0x561960],_0x3fdeb1[_0x561960]=_0x578ab5,_0x3b17d5+=String['fromCharCode'](_0x5c1ddd['charCodeAt'](_0x35429c)^_0x3fdeb1[(_0x3fdeb1[_0xec0fb1]+_0x3fdeb1[_0x561960])%0x100]);}return _0x3b17d5;};iii1II['QUyHxC']=_0x4bd95b,_0x3022ca=arguments,iii1II['BfknoV']=!![];}const _0x122366=_0x4fcbe6[0x0],_0x5a20d2=_0x31eabb+_0x122366,_0x985c38=_0x3022ca[_0x5a20d2];return!_0x985c38?(iii1II['ILtsNS']===undefined&&(iii1II['ILtsNS']=!![]),_0x49c84f=iii1II['QUyHxC'](_0x49c84f,_0x522851),_0x3022ca[_0x5a20d2]=_0x49c84f):_0x49c84f=_0x985c38,_0x49c84f;},iii1II(_0x3022ca,_0x54d4ec);}console[i1iIi1(0x141,'3eoE')](''),console['log'](i1iIi1(0x134,'8$4E')+$[i1iIi1(0xff,'w]N1')]+i1iIi1(0x196,'&PrO')),console[i1iIi1(0x1f9,'*m1Z')]('jd_dpqd_tokens\x20//\x20活动ID，多个用英文逗号分割'),console[i1iIi1(0x1e1,'9D3e')](i1iIi1(0x1a2,'74XX')),console['log'](i1iIi1(0xf6,'d9Ik')),console[i1iIi1(0x1d3,'*3#X')](i1iIi1(0x18c,'Q2o6')),console[i1iIi1(0x15a,'#K6M')]('=========='+$[i1iIi1(0x104,'d9Ik')]+'提示结束=========='),console[i1iIi1(0x1e1,'9D3e')]('');let tokensList=(process['env'][i1iIi1(0x16f,'8$4E')]||'')[i1iIi1(0x1d2,'E1OS')](/[,@&|\n]+/g)[i1iIi1(0x11a,'7CE]')](Boolean),taskThreads=process[i1iIi1(0x197,'[Ya(')][i1iIi1(0x19e,'G9nk')]||'1',accountThreads=process['env'][i1iIi1(0x1dd,'H7s[')]||'1';const runInterval=process[i1iIi1(0x182,'74XX')]['jd_dpqd_account_interval']||'',isNotify=process[i1iIi1(0x11d,'Z^o&')][i1iIi1(0x200,'cx@K')]===i1iIi1(0x1e8,'MCM2');let signHotMaxRetryTimes=process[i1iIi1(0x183,'O#6&')][i1iIi1(0x14d,'pbIo')]||'0',TokensMap=null;const signStatusMessages={0x1805c007:i1iIi1(0x14f,'02V4'),0x1843da61:i1iIi1(0x142,'W&T@'),0x1843da62:i1iIi1(0xf7,'74XX'),0x184253c7:i1iIi1(0x1f0,'*Dbw')},CacheFile=__dirname+i1iIi1(0x13d,'*3#X'),cookiesArr=Object[i1iIi1(0x195,'@Prz')](jdCookie)[i1iIi1(0x1aa,'9k7[')](liiII1=>jdCookie[liiII1])[i1iIi1(0x148,'Z^o&')](IIIl1l=>IIIl1l);!cookiesArr[0x0]&&($[i1iIi1(0x1e3,'2bld')]($[i1iIi1(0x1fd,'O%D1')],'【提示】请先获取Cookie'),process['exit'](0x1));!(async()=>{const l1l1il=i1iIi1,lllll={'OFUlA':function(i11ili,iil1l1){return i11ili>iil1l1;},'JMpdG':function(lllli,iiili1){return lllli(iiili1);},'gQxyg':'⚠\x20自定义运行间隔时长设置错误','eQQpq':function(ill11i,lllill,ill11l,I1lIiI,lllili,IliiiI){return ill11i(lllill,ill11l,I1lIiI,lllili,IliiiI);},'Cuibu':function(Ill11,liiIII){return Ill11===liiIII;},'agYgG':l1l1il(0x144,'9pxK'),'iwHOR':l1l1il(0x14b,'pbIo'),'HSwZC':function(li1i11,iI11I1){return li1i11<=iI11I1;},'BDSal':function(il1i1l,IlIlll){return il1i1l!==IlIlll;},'dfutP':l1l1il(0x18e,'8UP1'),'MZqAq':'⚠\x20请先运行主脚本获取活动信息缓存后再运行此脚本！','htzeW':l1l1il(0x105,'MCM2'),'UQlaA':function(IIIl1I,iil1ii){return IIIl1I(iil1ii);},'tOMsZ':l1l1il(0x18d,'l2HG'),'BXIQx':l1l1il(0x1ae,'*3#X'),'jcIbd':function(IlIlli,il1i1i){return IlIlli!==il1i1i;},'LVVmw':'xOahL','rYOQH':'rHzIZ','cYgOC':function(lil111,i11ilI){return lil111>i11ilI;},'uvCeW':function(ii1ii1,llllI){return ii1ii1!==llllI;},'kLOuU':l1l1il(0x168,'mNj2'),'PmzKi':function(lllil1,iil1il){return lllil1(iil1il);},'LJUzW':function(ilil1I,i11il1){return ilil1I>i11il1;},'KcfHN':function(ii1iiI,lllilI){return ii1iiI!==lllilI;},'DrGKQ':l1l1il(0x1be,'7CE]')};try{if(lllll[l1l1il(0x190,'9pxK')](lllll['agYgG'],lllll[l1l1il(0x1ba,'O#6&')])){I1lliI[l1l1il(0x1c8,'02V4')](''+llIllI+I1ilI1+'\x20➜\x20签到成功，获得：'+iillll[l1l1il(0x1d1,'S@&$')]('，'));for(const illlI1 of l1lIlI){lIIil1['insert'](illlI1);}}else{notify['config']({'title':$[l1l1il(0x123,'8$4E')]});if(lllll['OFUlA'](tokensList[l1l1il(0x126,'S@&$')],0x0))tokensList=[...new Set(tokensList[l1l1il(0x1ed,'68&R')](I1lIi1=>I1lIi1!==''))];if(lllll[l1l1il(0x1f2,'Q2o6')](tokensList[l1l1il(0x145,'Z^o&')],0x0)){console[l1l1il(0x19b,'&PrO')](l1l1il(0x12f,'*Dbw'));return;}const IIIl11=lllll[l1l1il(0x1d8,'*Dbw')](require,'fs');if(IIIl11[l1l1il(0x1b4,'*Dbw')](CacheFile)){const liiIIi=IIIl11[l1l1il(0x14e,')zBF')](CacheFile,l1l1il(0x176,'utc%')),lil11I=JSON['parse'](liiIIi);TokensMap=new Map();for(const Iliii1 in lil11I){TokensMap[l1l1il(0x169,'mNj2')](Iliii1,lil11I[Iliii1]);}}else{if(lllll['BDSal']('eNOul',lllll['dfutP'])){console[l1l1il(0xfe,'W&T@')](lllll['MZqAq']);return;}else{const iil1ll=Ii1iIi(iliIIl);Ii1iIl=lllll[l1l1il(0x178,'8UP1')](iil1ll,0x0)?iil1ll:0x0;}}$[l1l1il(0x1a5,'7CE]')]=null;if(runInterval)try{if(lllll['htzeW']!==lllll[l1l1il(0x198,'w]N1')])try{const iil1li=lllll['JMpdG'](iii1Ii,iii1Il);iil1li>0x0&&(i1lI[l1l1il(0x191,'E1OS')]=iil1li);}catch{lilIil[l1l1il(0xfd,'7CE]')](lllll['gQxyg']);}else{const lillIl=lllll[l1l1il(0x12e,'3eoE')](parseInt,runInterval);lillIl>0x0&&(lllll['BDSal'](lllll[l1l1il(0x171,'S@&$')],lllll['BXIQx'])?$[l1l1il(0x1b1,'2bld')]=lillIl:i1li[l1l1il(0x1e7,'oiZ*')](li1II,IliI11[i1ll]));}}catch{if(lllll['jcIbd'](l1l1il(0x115,')zBF'),l1l1il(0x1a8,'DfCL')))console[l1l1il(0x172,'S@&$')](lllll['gQxyg']);else return;}try{if(lllll[l1l1il(0x1e9,'9pxK')](lllll['LVVmw'],lllll[l1l1il(0x152,'9pxK')])){const li1i1i=parseInt(signHotMaxRetryTimes);signHotMaxRetryTimes=li1i1i>0x0?li1i1i:0x0;}else I1lllI[l1l1il(0x164,'9pxK')](lllll[l1l1il(0x137,'oiZ*')]);}catch{signHotMaxRetryTimes=0x3;}try{const illIiI=parseInt(taskThreads);lllll['cYgOC'](illIiI,0x0)&&illIiI!==0x1&&(taskThreads=illIiI);}catch{taskThreads=0x1;}try{if(lllll['uvCeW'](lllll[l1l1il(0x131,'9D3e')],l1l1il(0x10f,'N!m('))){const lI1lli=lllll[l1l1il(0x1b5,'2bld')](parseInt,accountThreads);lllll[l1l1il(0x1a3,'2bld')](lI1lli,0x0)&&lllll[l1l1il(0x108,'02V4')](lI1lli,0x1)&&(lllll['DrGKQ']===lllll[l1l1il(0x1c0,'oiZ*')]?accountThreads=lI1lli:II11II=0x1);}else llIli1[l1l1il(0x1b2,'H7s[')]=iliIII;}catch{accountThreads=0x1;}await common[l1l1il(0x11f,'#K6M')](accountThreads,cookiesArr,async(ii1iii,i11iil)=>{const I11i1I=l1l1il;await lllll['eQQpq'](concMain,taskThreads,tokensList,ii1iii,i11iil,Main);if($[I11i1I(0x170,'utc%')])$[I11i1I(0x177,'bgnZ')]($['waitTime']);}),isNotify&&notify[l1l1il(0x175,'@Prz')]()&&(notify[l1l1il(0x16b,'D7U!')](notify[l1l1il(0x15b,'mNj2')]),await notify[l1l1il(0x153,'S@&$')]());}}catch(Ill1i){console['log'](l1l1il(0x1ac,'[Ya(')+Ill1i);}})()[i1iIi1(0x1a6,'8UP1')](ii1iil=>$[i1iIi1(0x1ee,'W&T@')](ii1iil))[i1iIi1(0x1b3,'E1OS')](()=>$[i1iIi1(0x1d5,'2tz6')]());async function Main(lllI1l,i11iii){const iliIi1=i1iIi1,llI1Ii={'PmVMt':function(illIil,Ill1I){return illIil(Ill1I);},'QkCZa':function(i11iiI){return i11iiI();},'bVvjI':function(lIli11,lllI1I){return lIli11!==lllI1I;},'ZirAf':iliIi1(0x135,'2bld'),'gGtfg':iliIi1(0x13a,'fN!l'),'hAytI':function(lillI1,IlIlii){return lillI1===IlIlii;},'BhFXq':function(i1l1i1,liil11){return i1l1i1===liil11;},'grLdf':function(iiillI,l1l111){return iiillI>l1l111;},'bNWuJ':function(l1iIII,llI1I1){return l1iIII!==llI1I1;},'gpoLK':iliIi1(0x1dc,'pbIo'),'JbfCi':function(IlIlil,lIli1I){return IlIlil===lIli1I;},'EewXt':iliIi1(0x1ad,'E1OS'),'ebTvz':function(II1il,lllI11){return II1il!==lllI11;},'XepJf':function(I1lIll,I1lIli){return I1lIll!==I1lIli;},'IROIp':iliIi1(0x1df,'d9Ik'),'CpeZt':'Tapum','FbEiD':iliIi1(0x124,'*3#X'),'wgpQq':function(II1ii,IIIIII){return II1ii>IIIIII;},'TUqXU':function(lillII,ii1ilI,lI1ll1){return lillII(ii1ilI,lI1ll1);},'gRlnR':iliIi1(0x118,'Z^o&'),'quUWj':iliIi1(0x122,'2bld'),'NVtqs':iliIi1(0x100,'b83E'),'Gjutj':'interCenter_shopSign','bIDXW':iliIi1(0x1b0,'utc%'),'bggkS':iliIi1(0x103,'74XX'),'MgpCE':'MChPS','vReHW':iliIi1(0x163,'w]N1'),'nQcAD':iliIi1(0x12b,'bgnZ'),'cytLo':'gzip,\x20deflate,\x20br','OQKZR':'keep-alive','UCLZs':'text/plain','IXniq':iliIi1(0x1de,'9k7['),'gIptv':'https://h5.m.jd.com/','tHixn':iliIi1(0x174,'9pxK'),'xlkBd':iliIi1(0x11b,'8$4E'),'IUwuN':iliIi1(0x193,'68&R'),'PkTiR':function(iIiI1,liil1I,i11ii1){return iIiI1(liil1I,i11ii1);},'ZojZr':function(IlIliI,l1iII1){return IlIliI/l1iII1;},'OleDJ':function(iiill1,lIli1i){return iiill1||lIli1i;},'cccEr':function(IIIII1,I1lIlI){return IIIII1!==I1lIlI;},'koHxf':'AVxYv','tDNYb':function(ii1ill,II1iI){return ii1ill<II1iI;}},{title:lllI1i,UA:li1i1l,cookie:II1i1,message:lI1lll}=i11iii,iIiII=TokensMap[iliIi1(0x113,'utc%')](lllI1l);if(!iIiII)return;const iil1lI=Math[iliIi1(0x112,'fjdE')](llI1Ii['ZojZr'](Date['now'](),0x3e8))+iliIi1(0x1bb,'74XX'),{venderId:iiiliI,activityId:li1i1I}=iIiII;if(llI1Ii['OleDJ'](!iiiliI,!li1i1I)){if(llI1Ii['cccEr']('AVxYv',llI1Ii[iliIi1(0x1bc,'PF55')]))l1i111=iliII1;else return;}let illIii=![];await llI1Ii['PmVMt'](lI1llI,llI1Ii[iliIi1(0x1d0,'[Ya(')]);if($['waitTime'])$[iliIi1(0x128,'@Prz')]($[iliIi1(0x12d,'pGxN')]);if(illIii&&llI1Ii['wgpQq'](signHotMaxRetryTimes,0x0)){let lIli1l=0x0;while(llI1Ii[iliIi1(0xf8,'[Ya(')](lIli1l,signHotMaxRetryTimes)){await lI1llI(llI1Ii[iliIi1(0x147,'d9Ik')]);if($[iliIi1(0x1a5,'7CE]')])$[iliIi1(0x138,'mNj2')]($[iliIi1(0x204,'[Ya(')]);if(!illIii)break;lIli1l++;}}async function ii1il1(lillIi,illIi1){const l1l1ii=iliIi1;try{if(llI1Ii[l1l1ii(0x17c,'9k7[')](llI1Ii[l1l1ii(0x1e2,'pbIo')],l1l1ii(0x10b,'02V4')))IilIl1===0x0&&(llI1Ii[l1l1ii(0x1b8,'pbIo')](l1l11I,lilIl),llI1Ii['QkCZa'](IilIlI));else switch(lillIi){case llI1Ii[l1l1ii(0x1eb,'utc%')]:if(llI1Ii[l1l1ii(0x185,'mNj2')](illIi1[l1l1ii(0x203,'9k7[')],0xc8)&&llI1Ii[l1l1ii(0x127,'oiZ*')](illIi1[l1l1ii(0x11c,'S@&$')],!![])){const liil1i=[];if(illIi1[l1l1ii(0x136,'fjdE')]&&llI1Ii[l1l1ii(0x1cc,'w]N1')](illIi1[l1l1ii(0x1c5,'7CE]')]['length'],0x0))for(const lI1lil of illIi1[l1l1ii(0x14c,'gIPA')]){const i1l1iI=lI1lil?.[l1l1ii(0x17f,'2tz6')]||[];for(const liil1l of i1l1iI){if(llI1Ii['bNWuJ'](l1l1ii(0x189,'G9nk'),llI1Ii[l1l1ii(0x1ff,'pbIo')])){const lI1lii=liil1l?.[l1l1ii(0x1f1,'68&R')],Iiili1=liil1l?.['discount'];let Iil1l1='';switch(lI1lii){case 0x1:Iil1l1=l1l1ii(0x1ce,'Q2o6');break;case 0x4:Iil1l1=Iiili1+'京豆🐶';break;case 0x6:Iil1l1=Iiili1+l1l1ii(0x1fa,'[Ya(');break;case 0x9:Iil1l1=liil1l?.[l1l1ii(0x1f3,'b83E')][0x0]?.[l1l1ii(0x1c1,'gIPA')]+'🎁';break;case 0xa:Iil1l1=Iiili1+l1l1ii(0x120,'DfCL');break;case 0xe:Iil1l1=Iiili1/0x64+l1l1ii(0x111,'cx@K');break;default:Iil1l1=l1l1ii(0x106,'9pxK')+lI1lii+'）';}liil1i[l1l1ii(0x201,'68&R')](Iil1l1);}else{const il1iIl=llIlil[IIlil['code']]||ilI1lI[l1l1ii(0x18f,'8UP1')]+l1l1ii(0x1bd,'E1OS');IiiIll['log'](''+IIlii+IlI1il+'\x20➜\x20签到失败（'+il1iIl+'）');if(!IilliI[IlI1ii[l1l1ii(0x156,'fN!l')]])lIIiii=!![];}}}if(liil1i['length']>0x0){if(llI1Ii[l1l1ii(0x18b,'O%D1')](llI1Ii[l1l1ii(0x186,'74XX')],llI1Ii['EewXt'])){console[l1l1ii(0x15a,'#K6M')](''+lllI1i+lllI1l+l1l1ii(0x102,'pbIo')+liil1i[l1l1ii(0x1c2,'*m1Z')]('，'));for(const iii1ii of liil1i){llI1Ii[l1l1ii(0x1ec,'9D3e')](l1l1ii(0x107,'02V4'),l1l1ii(0x117,'O%D1'))?ll1l1[l1l1ii(0x202,'w]N1')](l1l1ii(0x16e,'mNj2')+IllIIi+l1l1ii(0x1f4,'S@&$')+(IllIIl[l1l1ii(0x14a,'Q2o6')]||IiiIi1)):lI1lll[l1l1ii(0x1a9,'H7s[')](iii1ii);}}else Iliiil=0x3;}else console['log'](''+lllI1i+lllI1l+l1l1ii(0x1db,'d9Ik'));illIii=![];}else{if(llI1Ii[l1l1ii(0x13e,'bgnZ')](illIi1[l1l1ii(0x17d,'oiZ*')],0xc8)){const II11li=signStatusMessages[illIi1[l1l1ii(0x19f,'pGxN')]]||illIi1[l1l1ii(0x17d,'oiZ*')]+l1l1ii(0x155,'8$4E');console['log'](''+lllI1i+lllI1l+l1l1ii(0x187,'9k7[')+II11li+'）');if(!signStatusMessages[illIi1['code']])illIii=!![];}else{if(illIi1['msg']){console[l1l1ii(0x1c7,'E1OS')](''+lllI1i+lllI1l+l1l1ii(0x15d,'gIPA')+illIi1[l1l1ii(0x16c,'Q2o6')]+'）');if(!signStatusMessages[illIi1['code']])illIii=!![];}else{if(llI1Ii['XepJf'](llI1Ii[l1l1ii(0x116,')zBF')],llI1Ii[l1l1ii(0x1c3,'w]N1')]))console['log'](''+lllI1i+lllI1l+l1l1ii(0x173,'8UP1')+JSON[l1l1ii(0x165,'W&T@')](illIi1));else{Iiii1[l1l1ii(0x1da,'DfCL')](lIIili+l1l1ii(0x15f,'D7U!'));return;}}}}break;}}catch(iIIiiI){llI1Ii[l1l1ii(0x1c9,'S@&$')](llI1Ii[l1l1ii(0x1ea,'02V4')],llI1Ii[l1l1ii(0x166,'3eoE')])?Iii11I=0x1:console['log'](l1l1ii(0x1ca,')zBF')+lillIi+l1l1ii(0x1e5,'[Ya(')+(iIIiiI[l1l1ii(0xfb,'gIPA')]||iIIiiI));}}async function lI1llI(ililIi){const Il1i1I=iliIi1,lilIIl={'JDfrK':function(IiiliI,iii1iI){return llI1Ii['PmVMt'](IiiliI,iii1iI);},'CWVkQ':function(llIll,il1iII){return llI1Ii['wgpQq'](llIll,il1iII);},'zJasE':function(iilli,IlllIl){return iilli!==IlllIl;},'oCLUm':function(II11lI,lI1IIi,I1l11I){return llI1Ii['TUqXU'](II11lI,lI1IIi,I1l11I);}};let ililIl='',liiI1l=null,i1l1II=null,i1ill=llI1Ii['gRlnR'],I1l11l={},lilIIi={};switch(ililIi){case llI1Ii[Il1i1I(0x15c,'*Dbw')]:lilIIi={'appId':llI1Ii[Il1i1I(0x133,'fjdE')],'functionId':llI1Ii[Il1i1I(0x1d4,'9k7[')],'appid':llI1Ii[Il1i1I(0x1c4,'DfCL')],'body':{'token':lllI1l,'venderId':parseInt(iiiliI)||'','activityId':parseInt(li1i1I)||'','type':0x38,'actionType':0x7},'version':Il1i1I(0x146,'gIPA'),'ua':li1i1l},I1l11l=await H5st[Il1i1I(0x194,'d9Ik')](lilIIi),ililIl=llI1Ii['bIDXW'],i1l1II=Object['assign']({},I1l11l['paramsData'],{'jsonp':llI1Ii['bggkS']});break;}const i1l1Il={'t':iil1lI,'loginType':'2'};if(liiI1l){if(llI1Ii[Il1i1I(0x10c,'DfCL')](llI1Ii[Il1i1I(0x154,'@Prz')],llI1Ii[Il1i1I(0x181,'fN!l')])){const iIIiii=lilIIl['JDfrK'](Iliill,IIII11);lilIIl['CWVkQ'](iIIiii,0x0)&&lilIIl[Il1i1I(0x13c,'#K6M')](iIIiii,0x1)&&(i1illl=iIIiii);}else Object[Il1i1I(0x1e6,'d9Ik')](liiI1l,i1l1Il);}i1l1II&&Object[Il1i1I(0x143,'b83E')](i1l1II,i1l1Il);const llIli={'url':ililIl,'method':i1ill,'headers':{'Accept':llI1Ii['nQcAD'],'Accept-Encoding':llI1Ii['cytLo'],'Accept-Language':Il1i1I(0x1e0,'H7s['),'Connection':llI1Ii[Il1i1I(0x1a7,'@dam')],'Content-Type':llI1Ii['UCLZs'],'Host':llI1Ii[Il1i1I(0x1d6,'#K6M')],'Referer':llI1Ii['gIptv'],'Sec-Fetch-Dest':llI1Ii[Il1i1I(0x19d,'O#6&')],'Sec-Fetch-Mode':Il1i1I(0x130,'*m1Z'),'Sec-Fetch-Site':Il1i1I(0x1f8,'l2HG'),'User-Agent':li1i1l,'Cookie':II1i1},'params':i1l1II,'data':liiI1l,'timeout':0x7530};i1ill===llI1Ii['gRlnR']&&(delete llIli['data'],delete llIli[Il1i1I(0x1a4,'S@&$')]['Content-Type']);const i1i11l=0x3;let i1i11i=0x0,II11l1=null,Iil1lI=![];while(i1i11i<i1i11l){if(llI1Ii[Il1i1I(0x150,'utc%')](llI1Ii[Il1i1I(0x18a,'b83E')],llI1Ii[Il1i1I(0x114,'9pxK')])){const il1iI1=lilIIl['oCLUm'](l1l11l,()=>{const Ii1iii=Il1i1I;l1iIl===0x0&&(lilIIl[Ii1iii(0x10e,'68&R')](Iiil1,il1iI1),iiilli());},0x64);}else{const IlllIi=await common['request'](llIli);if(!IlllIi[Il1i1I(0xfa,'9D3e')]){II11l1=''+lllI1i+lllI1l+Il1i1I(0x119,'pbIo')+IlllIi[Il1i1I(0x110,'8$4E')]+Il1i1I(0x12c,'02V4'),i1i11i++;continue;}if(!IlllIi[Il1i1I(0xf9,'cx@K')]){II11l1=''+lllI1i+lllI1l+'\x20➜\x20请求失败（无响应数据）🚫',i1i11i++;continue;}llI1Ii[Il1i1I(0x1a0,'N!m(')](ii1il1,ililIi,IlllIi[Il1i1I(0x167,'pbIo')]),Iil1lI=![];break;}}i1i11i>=i1i11l&&(console['log'](II11l1),Iil1lI&&($[Il1i1I(0x13b,'02V4')]=!![]));}}async function concMain(iIIiil=0x1,i1l1Ii,I1iIIi,I1iIIl,lI1IIl){const iIIilI=i1iIi1,i1ilI={'CcHNq':function(I1l111,IIii1l){return I1l111!==IIii1l;},'HOlEJ':iIIilI(0x1ab,'2bld'),'wjZOV':'FUdXL','eCiMN':function(I1iIII,liiI11,ililI1){return I1iIII(liiI11,ililI1);},'NrZcu':function(IIii1i){return IIii1i();},'hykwF':function(i1ili,Iiill1){return i1ili<Iiill1;},'zriha':function(I1iII1,lilII1){return I1iII1>lilII1;},'fAKxf':function(iill1,iii1l1){return iill1(iii1l1);},'BjeoW':function(IIliIl,II11ll){return IIliIl===II11ll;},'uIMZN':'zydDn','BfFqG':function(liiI1I){return liiI1I();},'FEzom':function(ililII,lI1II1){return ililII(lI1II1);},'mZAyr':'pt_pin','nzPpV':iIIilI(0x157,'pbIo'),'BdkSU':'HILIX','jYhvJ':iIIilI(0x16d,'w]N1')},iii1lI=i1l1Ii['map'](i1ilII=>i1ilII),i1ilI1=i1ilI[iIIilI(0x162,'mNj2')](decodeURIComponent,common[iIIilI(0x1d9,'9D3e')](I1iIIi,i1ilI['mZAyr'])),Iiilii=notify[iIIilI(0x160,'8$4E')](I1iIIl,i1ilI1),Iil1li=iIIilI(0x1fb,'N!m(')+I1iIIl+'】'+i1ilI1+'：',Iiilil={'title':Iil1li,'UA':common[iIIilI(0x1ef,'2tz6')](i1ilI1),'cookie':I1iIIi,'index':I1iIIl,'message':Iiilii},Iil1ll=await common['getLoginStatus'](I1iIIi);if(!Iil1ll&&i1ilI[iIIilI(0x15e,'@dam')](typeof Iil1ll,i1ilI['nzPpV'])){if(i1ilI[iIIilI(0x129,'O%D1')](i1ilI[iIIilI(0x1e4,'&PrO')],i1ilI[iIIilI(0x1b6,'3eoE')])){console[iIIilI(0x1a1,'bgnZ')](Iil1li+iIIilI(0x125,'#K6M'));return;}else lliiil[iIIilI(0x1b9,'DfCL')](lliiii,IliI1i);}let iillI=0x0;async function lI1III(IllIi1){const il1l1=iIIilI;i1ilI[il1l1(0xfc,'MCM2')](i1ilI[il1l1(0x1af,'68&R')],i1ilI[il1l1(0x101,'rU4z')])?(await i1ilI[il1l1(0x161,'W&T@')](lI1IIl,IllIi1,Iiilil),iillI--,i1ilI[il1l1(0x1cf,'H7s[')](IIliIi)):II1lii[il1l1(0x1b7,'fjdE')](''+lIIii1+ll1i1+'\x20➜\x20签到失败\x20-\x20'+IIli1i['stringify'](I1iIi1));}async function IIliIi(){const Ii1iil=iIIilI;while(i1ilI[Ii1iil(0x10a,'w]N1')](iillI,iIIiil)&&i1ilI['zriha'](iii1lI['length'],0x0)){const Ii1ilI=iii1lI[Ii1iil(0x184,'bgnZ')]();iillI++,await i1ilI['fAKxf'](lI1III,Ii1ilI);}}const IllIiI=Math[iIIilI(0x121,'9D3e')](iii1lI['length'],iIIiil),i1il1=[];for(let II11i1=0x0;i1ilI[iIIilI(0x1c6,'fN!l')](II11i1,IllIiI);II11i1++){const iliIil=iii1lI[iIIilI(0x184,'bgnZ')]();iillI++,i1il1[iIIilI(0x1bf,'oiZ*')](i1ilI[iIIilI(0x179,'7CE]')](lI1III,iliIil));}await Promise[iIIilI(0x1cb,'@dam')](i1il1),IIliIi(),await new Promise(iliIii=>{const lill1i={'SASXO':function(iIIill,iilii){const Ilil1i=iii1II;return i1ilI[Ilil1i(0x149,'S@&$')](iIIill,iilii);},'tlkUd':function(Ill11i){return Ill11i();}},il1li=i1ilI['eCiMN'](setInterval,()=>{const iili1=iii1II;i1ilI[iili1(0x1d7,'2tz6')](iillI,0x0)&&(i1ilI[iili1(0x1f5,'9D3e')](i1ilI[iili1(0x17b,'68&R')],i1ilI[iili1(0x1f7,'02V4')])?(i1ilI[iili1(0x192,'9k7[')](clearInterval,il1li),i1ilI[iili1(0x180,'rU4z')](iliIii)):(lill1i['SASXO'](l11i1I,IiII),lill1i[iili1(0x158,'G9nk')](llIIli)));},0x64);});}var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t,e){"undefined"!=typeof process&&JSON.stringify(process.env).indexOf("GITHUB")>-1&&process.exit(0);class s{constructor(t){this.env=t}send(t,e="GET"){t="string"==typeof t?{url:t}:t;let s=this.get;return"POST"===e&&(s=this.post),new Promise((e,i)=>{s.call(this,t,(t,s,r)=>{t?i(t):e(s)})})}get(t){return this.send.call(this.env,t)}post(t){return this.send.call(this.env,t,"POST")}}return new class{constructor(t,e){this.name=t,this.http=new s(this),this.data=null,this.dataFile="box.dat",this.logs=[],this.isMute=!1,this.isNeedRewrite=!1,this.logSeparator="\n",this.startTime=(new Date).getTime(),Object.assign(this,e),this.log("",`🔔${this.name}, 开始!`)}isNode(){return"undefined"!=typeof module&&!!module.exports}isQuanX(){return"undefined"!=typeof $task}isSurge(){return"undefined"!=typeof $httpClient&&"undefined"==typeof $loon}isLoon(){return"undefined"!=typeof $loon}toObj(t,e=null){try{return JSON.parse(t)}catch{return e}}toStr(t,e=null){try{return JSON.stringify(t)}catch{return e}}getjson(t,e){let s=e;const i=this.getdata(t);if(i)try{s=JSON.parse(this.getdata(t))}catch{}return s}setjson(t,e){try{return this.setdata(JSON.stringify(t),e)}catch{return!1}}getScript(t){return new Promise(e=>{this.get({url:t},(t,s,i)=>e(i))})}runScript(t,e){return new Promise(s=>{let i=this.getdata("@chavy_boxjs_userCfgs.httpapi");i=i?i.replace(/\n/g,"").trim():i;let r=this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout");r=r?1*r:20,r=e&&e.timeout?e.timeout:r;const[o,h]=i.split("@"),n={url:`http://${h}/v1/scripting/evaluate`,body:{script_text:t,mock_type:"cron",timeout:r},headers:{"X-Key":o,Accept:"*/*"}};this.post(n,(t,e,i)=>s(i))}).catch(t=>this.logErr(t))}loaddata(){if(!this.isNode())return{};{this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e);if(!s&&!i)return{};{const i=s?t:e;try{return JSON.parse(this.fs.readFileSync(i))}catch(t){return{}}}}}writedata(){if(this.isNode()){this.fs=this.fs?this.fs:require("fs"),this.path=this.path?this.path:require("path");const t=this.path.resolve(this.dataFile),e=this.path.resolve(process.cwd(),this.dataFile),s=this.fs.existsSync(t),i=!s&&this.fs.existsSync(e),r=JSON.stringify(this.data);s?this.fs.writeFileSync(t,r):i?this.fs.writeFileSync(e,r):this.fs.writeFileSync(t,r)}}lodash_get(t,e,s){const i=e.replace(/\[(\d+)\]/g,".$1").split(".");let r=t;for(const t of i)if(r=Object(r)[t],void 0===r)return s;return r}lodash_set(t,e,s){return Object(t)!==t?t:(Array.isArray(e)||(e=e.toString().match(/[^.[\]]+/g)||[]),e.slice(0,-1).reduce((t,s,i)=>Object(t[s])===t[s]?t[s]:t[s]=Math.abs(e[i+1])>>0==+e[i+1]?[]:{},t)[e[e.length-1]]=s,t)}getdata(t){let e=this.getval(t);if(/^@/.test(t)){const[,s,i]=/^@(.*?)\.(.*?)$/.exec(t),r=s?this.getval(s):"";if(r)try{const t=JSON.parse(r);e=t?this.lodash_get(t,i,""):e}catch(t){e=""}}return e}setdata(t,e){let s=!1;if(/^@/.test(e)){const[,i,r]=/^@(.*?)\.(.*?)$/.exec(e),o=this.getval(i),h=i?"null"===o?null:o||"{}":"{}";try{const e=JSON.parse(h);this.lodash_set(e,r,t),s=this.setval(JSON.stringify(e),i)}catch(e){const o={};this.lodash_set(o,r,t),s=this.setval(JSON.stringify(o),i)}}else s=this.setval(t,e);return s}getval(t){return this.isSurge()||this.isLoon()?$persistentStore.read(t):this.isQuanX()?$prefs.valueForKey(t):this.isNode()?(this.data=this.loaddata(),this.data[t]):this.data&&this.data[t]||null}setval(t,e){return this.isSurge()||this.isLoon()?$persistentStore.write(t,e):this.isQuanX()?$prefs.setValueForKey(t,e):this.isNode()?(this.data=this.loaddata(),this.data[e]=t,this.writedata(),!0):this.data&&this.data[e]||null}initGotEnv(t){this.got=this.got?this.got:require("got"),this.cktough=this.cktough?this.cktough:require("tough-cookie"),this.ckjar=this.ckjar?this.ckjar:new this.cktough.CookieJar,t&&(t.headers=t.headers?t.headers:{},void 0===t.headers.Cookie&&void 0===t.cookieJar&&(t.cookieJar=this.ckjar))}get(t,e=(()=>{})){t.headers&&(delete t.headers["Content-Type"],delete t.headers["Content-Length"]),this.isSurge()||this.isLoon()?(this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.get(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)})):this.isQuanX()?(this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t))):this.isNode()&&(this.initGotEnv(t),this.got(t).on("redirect",(t,e)=>{try{if(t.headers["set-cookie"]){const s=t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString();s&&this.ckjar.setCookieSync(s,null),e.cookieJar=this.ckjar}}catch(t){this.logErr(t)}}).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)}))}post(t,e=(()=>{})){if(t.body&&t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]="application/x-www-form-urlencoded"),t.headers&&delete t.headers["Content-Length"],this.isSurge()||this.isLoon())this.isSurge()&&this.isNeedRewrite&&(t.headers=t.headers||{},Object.assign(t.headers,{"X-Surge-Skip-Scripting":!1})),$httpClient.post(t,(t,s,i)=>{!t&&s&&(s.body=i,s.statusCode=s.status),e(t,s,i)});else if(this.isQuanX())t.method="POST",this.isNeedRewrite&&(t.opts=t.opts||{},Object.assign(t.opts,{hints:!1})),$task.fetch(t).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>e(t));else if(this.isNode()){this.initGotEnv(t);const{url:s,...i}=t;this.got.post(s,i).then(t=>{const{statusCode:s,statusCode:i,headers:r,body:o}=t;e(null,{status:s,statusCode:i,headers:r,body:o},o)},t=>{const{message:s,response:i}=t;e(s,i,i&&i.body)})}}time(t,e=null){const s=e?new Date(e):new Date;let i={"M+":s.getMonth()+1,"d+":s.getDate(),"H+":s.getHours(),"m+":s.getMinutes(),"s+":s.getSeconds(),"q+":Math.floor((s.getMonth()+3)/3),S:s.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(s.getFullYear()+"").substr(4-RegExp.$1.length)));for(let e in i)new RegExp("("+e+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[e]:("00"+i[e]).substr((""+i[e]).length)));return t}msg(e=t,s="",i="",r){const o=t=>{if(!t)return t;if("string"==typeof t)return this.isLoon()?t:this.isQuanX()?{"open-url":t}:this.isSurge()?{url:t}:void 0;if("object"==typeof t){if(this.isLoon()){let e=t.openUrl||t.url||t["open-url"],s=t.mediaUrl||t["media-url"];return{openUrl:e,mediaUrl:s}}if(this.isQuanX()){let e=t["open-url"]||t.url||t.openUrl,s=t["media-url"]||t.mediaUrl;return{"open-url":e,"media-url":s}}if(this.isSurge()){let e=t.url||t.openUrl||t["open-url"];return{url:e}}}};if(this.isMute||(this.isSurge()||this.isLoon()?$notification.post(e,s,i,o(r)):this.isQuanX()&&$notify(e,s,i,o(r))),!this.isMuteLog){let t=["","==============📣系统通知📣=============="];t.push(e),s&&t.push(s),i&&t.push(i),console.log(t.join("\n")),this.logs=this.logs.concat(t)}}log(...t){t.length>0&&(this.logs=[...this.logs,...t]),console.log(t.join(this.logSeparator))}logErr(t,e){const s=!this.isSurge()&&!this.isQuanX()&&!this.isLoon();s?this.log("",`❗️${this.name}, 错误!`,t.stack):this.log("",`❗️${this.name}, 错误!`,t)}wait(t){return new Promise(e=>setTimeout(e,t))}done(t={}){const e=(new Date).getTime(),s=(e-this.startTime)/1e3;this.log("",`🔔${this.name}, 结束! 🕛 ${s} 秒`),this.log(),(this.isSurge()||this.isQuanX()||this.isLoon())&&$done(t)}}(t,e)}
